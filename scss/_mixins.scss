// ============================================
// WIMS Modern Theme - Mixins
// ============================================

@use 'variables' as *;

// ============================================
// 1. RESPONSIVE BREAKPOINTS
// ============================================

@mixin respond-above($breakpoint) {
  @media (min-width: $breakpoint) {
    @content;
  }
}

@mixin respond-below($breakpoint) {
  @media (max-width: ($breakpoint - 1px)) {
    @content;
  }
}

@mixin respond-between($min, $max) {
  @media (min-width: $min) and (max-width: ($max - 1px)) {
    @content;
  }
}

// Convenience mixins
@mixin mobile-only {
  @include respond-below($breakpoint-md) {
    @content;
  }
}

@mixin tablet-up {
  @include respond-above($breakpoint-md) {
    @content;
  }
}

@mixin desktop-up {
  @include respond-above($breakpoint-lg) {
    @content;
  }
}

// ============================================
// 2. BUTTONS
// ============================================

@mixin button-base {
  display: inline-block;
  padding: $btn-padding-y $btn-padding-x;
  font-weight: $btn-font-weight;
  font-size: $font-size-base;
  line-height: $line-height-base;
  text-align: center;
  text-decoration: none;
  border: $border-width solid transparent;
  border-radius: $btn-border-radius;
  cursor: pointer;
  transition: $btn-transition;
  user-select: none;

  &:focus {
    outline: 2px solid currentColor;
    outline-offset: 2px;
  }

  &:disabled {
    opacity: 0.6;
    cursor: not-allowed;
  }
}

@mixin button-variant($bg-color, $color: $white, $hover-opacity: 0.9, $active-opacity: 0.8) {
  @include button-base;
  color: $color;
  background-color: $bg-color;
  border-color: $bg-color;

  &:hover:not(:disabled) {
    opacity: $hover-opacity;
    filter: brightness(0.9);
  }

  &:active:not(:disabled) {
    opacity: $active-opacity;
    filter: brightness(0.8);
  }
}

@mixin button-outline($color) {
  @include button-base;
  color: $color;
  background-color: transparent;
  border-color: $color;

  &:hover:not(:disabled) {
    color: $white;
    background-color: $color;
  }
}

@mixin button-size($padding-y, $padding-x, $font-size, $border-radius) {
  padding: $padding-y $padding-x;
  font-size: $font-size;
  border-radius: $border-radius;
}

// ============================================
// 3. FLEXBOX UTILITIES
// ============================================

@mixin flex-center {
  display: flex;
  align-items: center;
  justify-content: center;
}

@mixin flex-between {
  display: flex;
  align-items: center;
  justify-content: space-between;
}

@mixin flex-start {
  display: flex;
  align-items: center;
  justify-content: flex-start;
}

@mixin flex-end {
  display: flex;
  align-items: center;
  justify-content: flex-end;
}

@mixin flex-column {
  display: flex;
  flex-direction: column;
}

// ============================================
// 4. GRID UTILITIES
// ============================================

@mixin grid($columns: 12, $gap: $gap-medium) {
  display: grid;
  grid-template-columns: repeat($columns, 1fr);
  gap: $gap;
}

@mixin grid-auto-fit($min-width: 250px, $gap: $gap-medium) {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax($min-width, 1fr));
  gap: $gap;
}

@mixin grid-auto-fill($min-width: 250px, $gap: $gap-medium) {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax($min-width, 1fr));
  gap: $gap;
}

// ============================================
// 5. TYPOGRAPHY
// ============================================

@mixin heading-base {
  font-weight: $heading-font-weight;
  line-height: $heading-line-height;
  margin-bottom: $heading-margin-bottom;
  margin-top: 0;
}

@mixin text-truncate {
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

@mixin text-line-clamp($lines: 2) {
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-line-clamp: $lines;
  overflow: hidden;
}

// ============================================
// 6. VISIBILITY & DISPLAY
// ============================================

@mixin visually-hidden {
  position: absolute;
  width: 1px;
  height: 1px;
  margin: -1px;
  padding: 0;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border: 0;
}

@mixin clearfix {
  &::after {
    content: "";
    display: table;
    clear: both;
  }
}

// ============================================
// 7. CARDS & CONTAINERS
// ============================================

@mixin card {
  background-color: $card-bg;
  border-radius: $card-border-radius;
  padding: $card-padding;
  box-shadow: $card-shadow;
}

@mixin card-hover {
  transition: transform $transition-speed-base $transition-timing,
              box-shadow $transition-speed-base $transition-timing;

  &:hover {
    transform: translateY(-2px);
    box-shadow: $shadow-lg;
  }
}

@mixin container($max-width: $container-xl) {
  width: 100%;
  max-width: $max-width;
  margin-left: auto;
  margin-right: auto;
  padding-left: $spacing-4;
  padding-right: $spacing-4;
}

// ============================================
// 8. FORMS & INPUTS
// ============================================

@mixin input-base {
  display: block;
  width: 100%;
  padding: $input-padding-y $input-padding-x;
  font-size: $font-size-base;
  line-height: $line-height-base;
  color: $gray-900;
  background-color: $input-bg;
  border: $border-width solid $input-border-color;
  border-radius: $input-border-radius;
  transition: border-color $transition-speed-base $transition-timing,
              box-shadow $transition-speed-base $transition-timing;

  &:focus {
    border-color: $input-focus-border-color;
    outline: 0;
    box-shadow: 0 0 0 3px rgba($input-focus-border-color, 0.25);
  }

  &:disabled {
    background-color: $gray-200;
    opacity: 0.6;
    cursor: not-allowed;
  }
}

@mixin form-label {
  display: block;
  margin-bottom: $spacing-2;
  font-weight: $font-weight-medium;
  color: $gray-700;
}

// ============================================
// 9. TABLES
// ============================================

@mixin table-base {
  width: 100%;
  border-collapse: collapse;
  border-spacing: 0;

  th, td {
    padding: $table-cell-padding-y $table-cell-padding-x;
    text-align: left;
    border-bottom: $border-width solid $table-border-color;
  }

  th {
    background-color: $table-header-bg;
    color: $table-header-color;
    font-weight: $font-weight-semibold;
  }

  tbody tr {
    transition: background-color $transition-speed-fast $transition-timing;

    &:hover {
      background-color: $gray-100;
    }
  }
}

// ============================================
// 10. POSITION & ALIGNMENT
// ============================================

@mixin absolute-center {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
}

@mixin absolute-cover {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
}

@mixin sticky-top($offset: 0) {
  position: sticky;
  top: $offset;
  z-index: $z-index-sticky;
}

// ============================================
// 11. TRANSITIONS & ANIMATIONS
// ============================================

@mixin transition($properties...) {
  $transitions: ();

  @each $property in $properties {
    $transitions: append($transitions, $property $transition-speed-base $transition-timing, comma);
  }

  transition: $transitions;
}

@mixin fade-in($duration: $transition-speed-base) {
  animation: fadeIn $duration $transition-timing;
}

@keyframes fadeIn {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

@mixin slide-in-up($duration: $transition-speed-base) {
  animation: slideInUp $duration $transition-timing;
}

@keyframes slideInUp {
  from {
    opacity: 0;
    transform: translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

// ============================================
// 12. FOCUS VISIBLE (Accessibility)
// ============================================

@mixin focus-visible-outline($color: $primary-color, $offset: 2px) {
  &:focus-visible {
    outline: 2px solid $color;
    outline-offset: $offset;
  }
}

@mixin remove-focus-outline {
  &:focus {
    outline: none;
  }
}

// ============================================
// 13. SCROLLBAR STYLING
// ============================================

@mixin custom-scrollbar($thumb-color: $gray-400, $track-color: $gray-200, $width: 8px) {
  &::-webkit-scrollbar {
    width: $width;
    height: $width;
  }

  &::-webkit-scrollbar-track {
    background: $track-color;
  }

  &::-webkit-scrollbar-thumb {
    background: $thumb-color;
    border-radius: $border-radius-pill;

    &:hover {
      filter: brightness(0.9);
    }
  }
}

// ============================================
// 14. ASPECT RATIO
// ============================================

@mixin aspect-ratio($width: 16, $height: 9) {
  aspect-ratio: $width / $height;

  // Fallback for older browsers
  @supports not (aspect-ratio: 1) {
    position: relative;

    &::before {
      content: "";
      display: block;
      padding-bottom: percentage($height / $width);
    }

    > * {
      @include absolute-cover;
    }
  }
}

// ============================================
// 15. WIMS-SPECIFIC MIXINS
// ============================================

@mixin wims-widget {
  @include card;
  margin-bottom: $spacing-4;
}

@mixin wims-menu-item {
  @include flex-start;
  padding: $spacing-3 $spacing-4;
  color: $menu-color;
  text-decoration: none;
  transition: $transition-base;
  border-radius: $border-radius;

  &:hover {
    background-color: rgba($primary-color, 0.1);
    color: $primary-color;
  }

  &.active {
    background-color: rgba($primary-color, 0.15);
    color: $primary-color;
    font-weight: $font-weight-semibold;
  }
}

@mixin wims-button-help {
  @include button-variant($btn-help-bg, $btn-help-color);
}
